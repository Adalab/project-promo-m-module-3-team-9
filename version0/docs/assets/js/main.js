"use strict";const arrows=document.querySelectorAll(".js-arrow"),creationBtn=document.querySelector(".js-buttoncreate"),collapsibleSections=document.querySelectorAll(".js-section"),buttons=document.querySelectorAll(".js-input-design"),userData={name:"",job:"",email:"",linkedin:"",phone:"",github:"",palette:1,photo:""},inputName=document.querySelector(".js-inputname"),inputJob=document.querySelector(".js-inputjobtitle"),inputEmail=document.querySelector(".js-inputEmail"),inputTel=document.querySelector(".js-inputTel"),inputIn=document.querySelector(".js-inputIn"),inputGit=document.querySelector(".js-inputGit"),inputPhoto=document.querySelector(".js__profile-upload-btn"),cardName=document.querySelector(".js-previewname"),form=document.querySelector(".js-form"),cardJob=document.querySelector(".js-previewjob"),cardEmail=document.querySelector(".js-linkEmail"),cardTel=document.querySelector(".js-linkTel"),cardLinkedin=document.querySelector(".js-linkIn"),cardGitHub=document.querySelector(".js-linkGit"),resetButton=document.querySelector(".js-reset-button");function handleCollapsibles(e){let t=e.target.closest(".js-section");for(const e of collapsibleSections)t===e?e.classList.toggle("active"):e.classList.remove("active")}for(const e of arrows)e.addEventListener("click",handleCollapsibles);function changecolor(){const e=document.querySelector(".js-input-design:checked"),t=document.querySelector(".js-card");t.classList.remove("js-color-2"),t.classList.remove("js-color-3"),"1"===e.value||("2"===e.value?t.classList.add("js-color-2"):"3"===e.value&&t.classList.add("js-color-3")),userData.palette=parseInt(e.value),localStorage.setItem("user",JSON.stringify(userData))}for(let e=0;e<buttons.length;e++){buttons[e].addEventListener("click",changecolor)}function handleChangeForm(e){const t=e.target.value,r=e.target.name;"file"!==e.target.type&&(userData[r]=t,paintFormInCard(),localStorage.setItem("user",JSON.stringify(userData)))}function paintFormInCard(){""===userData.name?cardName.innerHTML="Nombre Apellidos":cardName.innerHTML=userData.name,""===userData.job?cardJob.innerHTML="Front end developer":cardJob.innerHTML=userData.job,cardEmail.href="mailto:"+userData.email,cardTel.href="tel:"+userData.phone,cardLinkedin.href="https://linkedin.com/in/"+userData.linkedin,cardGitHub.href="https://github.com/"+userData.github}function handleResetButton(){form.reset(),userData.name="",userData.job="",userData.email="",userData.linkedin="",userData.phone="",userData.github="",userData.palette=1,userData.photo="",localStorage.clear(),buttons[0].checked=!0,paintFormInCard(),paintPhotoInCard(),changecolor()}form.addEventListener("change",handleChangeForm),resetButton.addEventListener("click",handleResetButton);const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){userData.photo=fr.result,paintPhotoInCard(),localStorage.setItem("user",JSON.stringify(userData))}function paintPhotoInCard(){""===userData.photo?(profileImage.style.backgroundImage="",profilePreview.style.backgroundImage=""):(profileImage.style.backgroundImage=`url(${userData.photo})`,profilePreview.style.backgroundImage=`url(${userData.photo})`)}function fakeFileClick(){fileField.click()}function createMessageError(e){creationBtn.classList.add("errorButtonPress");const t=document.createElement("p"),r=document.querySelector(".js-errorcontainer"),a=document.createTextNode("Debes rellenar "+e);r.innerHTML="",r.appendChild(t),t.appendChild(a),t.setAttribute("class","CardCreated-a")}function handleButtonClickCreate(e){""===userData.name?createMessageError("el nombre"):""===userData.job?createMessageError("la profesion"):""===userData.email?createMessageError("el email"):""===userData.linkedin?createMessageError("el perfil de LinkedIn"):""===userData.phone?createMessageError("el telefono"):""===userData.github?createMessageError("el perfil de Github"):fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(userData)}).then(e=>e.json()).then(t=>{if(!1===t.success)createMessageError("la imagen");else{const r=e.target.closest(".collapsible");document.querySelector(".js-buttoncreate").classList.add("errorButtonPress");let a=document.querySelector(".js-link-card"),o=document.querySelector(".js-twitter-link");r.classList.toggle("showLink"),a.innerHTML=t.cardURL,a.href=t.cardURL,o.href="https://twitter.com/intent/tweet?ref_src=twsrc%5Etfw&url="+t.cardURL}}).catch(()=>{createMessageError("el formulario m√°s tarde!")})}function getData(){let e=JSON.parse(localStorage.getItem("user"));if(null!==e){for(const t of buttons){parseInt(t.value)===e.palette&&(t.checked=!0);const r=document.querySelector(".js-card");r.classList.remove("js-color-3"),r.classList.remove("js-color-2"),r.classList.add("js-color-"+e.palette),changecolor()}inputName.value=e.name,inputJob.value=e.job,inputEmail.value=e.email,inputTel.value=e.phone,inputIn.value=e.linkedin,inputGit.value=e.github,userData.name=e.name,userData.job=e.job,userData.email=e.email,userData.linkedin=e.linkedin,userData.phone=e.phone,userData.github=e.github,userData.photo=e.photo,paintFormInCard(),paintPhotoInCard()}}fileField.addEventListener("change",getImage),creationBtn.addEventListener("click",handleButtonClickCreate),getData();